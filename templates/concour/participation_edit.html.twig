{% extends "baseFront.html.twig" %}

{% block section %}

    <div style="max-width: 50%;box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.07);border-radius: 10px;position: relative;top: 25px;"
         class="container">
        <div class="row">

            <div class="col-xl-12 col-lg-12 col-md-8 col-sm-12 col-12">
                <div class="card">
                    <h5 class="card-header">Participation</h5>
                    <div class="card-body">
                        {{ form_start(form) }}


                        <div class="form-group col-md-10 ">
                            <label for="nom">Titre</label>
                            {{ form_widget(form.title,{'attr': {'class': 'form-control text-dark'} }) }}
                        </div>
                        <div class="form-group col-md-10">
                            <label for="sujet">Date</label>
                            {{ form_widget(form.publishDate,{'attr': {'class': 'form-control text-dark  '} }) }}
                        </div>

                        <div class="form-group col-md-10">
                            <label for="description">URL</label>
                            {{ form_widget(form.url,{'attr': {'class': 'form-control text-dark'} }) }}
                        </div>
                        <iframe width="540" height="315"  allowfullscreen frameborder="0"
                                src="{{participation.video.url}}" >
                        </iframe>
                        <div>
                            <button class="btn btn-success col" type="submit">Envoyer votre video</button>

                        </div>
                        {{ form_end(form) }}


                    </div>


                </div>
            </div>
        </div>

    </div>
    <script>

        function getId(url) {
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
            const match = url.match(regExp);

            return (match && match[2].length === 11)
                ? match[2]
                : null;
        }


        $( "#appbundle_video_url" )
            .ready(function() {

                let str ='//www.youtube.com/embed/'
                    + getId($("#appbundle_video_url").val());

                let $iframe = $('iframe');
                if ( $iframe.length ) {
                    $iframe.attr('src',str);
                    return false;
                }
                return true;

            })
        $( "#appbundle_video_url" )
            .focusout(function() {

                let str ='//www.youtube.com/embed/'
                    + getId($("#appbundle_video_url").val());

                let $iframe = $('iframe');
                if ( $iframe.length ) {
                    $iframe.attr('src',str);
                    return false;
                }
                return true;

            })

    </script>
{% endblock %}





